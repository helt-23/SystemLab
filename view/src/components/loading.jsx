import React, { useEffect } from 'react';
import { useLoading } from '../context/LoadingContext';
import { useParams } from 'react-router-dom';
import useLoadingAnimation from '../customHooks/useLoadingAnimation';
import '../assets/styles/loading.css';

const LoadingScreen = () => {
  const { shouldRender, animationProps } = useLoadingAnimation();
  const { filledParts, expand, showText } = animationProps;
  const { finishLoading } = useLoading();
  const { labId } = useParams();

  useEffect(() => {
    const timer = setTimeout(() => {
      finishLoading();
    }, 1500);

    return () => {
      clearTimeout(timer);
    };
  }, [labId, finishLoading]);

  if (!shouldRender) return null;

  return (
    <div className="loading-screen">
      <div className={`icon-container${expand ? ' expanded' : ''}`}>
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 811 962">
          <g>
            <path
              fill={filledParts >= 1 ? "#1d4ed8" : "none"}
              d="M413.110260,889.730103 C411.703644,881.000061 409.838776,872.681213 409.259033,864.273804 C408.126465,847.851074 407.432495,831.385010 407.064789,814.925598 C406.488495,789.129700 406.006958,763.323547 406.072113,737.523254 C406.186523,692.232300 418.346924,650.285950 443.536255,612.598633 C452.279083,599.517944 462.633636,587.408875 473.117004,575.625488 C484.720032,562.583618 496.711670,549.754028 509.668945,538.092957 C519.848938,528.931396 528.244629,518.742126 535.500549,507.303986 C552.685181,480.214478 563.571045,450.888824 568.197021,419.109955 C571.398132,397.119171 572.151123,375.057526 572.090698,352.893738 C572.064880,343.429535 574.525757,334.415314 580.126465,326.570374 C585.639648,318.848053 593.395447,315.913818 602.675110,316.713074 C614.832153,317.760193 624.212708,324.097961 632.084595,332.833069 C642.667725,344.576904 652.022522,357.247009 659.932861,370.982391 C668.776123,386.337433 675.510803,402.593048 680.813232,419.438202 C690.675720,450.770020 696.006653,482.833832 694.947510,515.751465 C694.071838,542.964783 688.492249,569.206299 677.342590,594.156677 C665.307922,621.087219 648.241028,644.506409 627.302246,665.117310 C612.128357,680.053650 596.750000,694.790405 581.193726,709.328125 C562.983826,726.345581 543.920715,742.486938 526.275330,760.060242 C510.768494,775.503723 496.013000,791.832397 482.177979,808.791748 C463.616547,831.544678 448.467438,856.542358 438.308105,884.327820 C437.188721,887.389404 435.474152,890.414490 433.380768,892.906372 C425.739227,902.002563 418.202087,900.862244 413.110260,889.730103"
            />
            <path
              fill={filledParts >= 2 ? "#1d4ed8" : "none"}
              d="M449.131653,385.068298 C431.119751,404.648254 413.030273,423.698700 395.446777,443.205292 C375.368195,465.479889 360.045410,490.531250 356.589203,520.948059 C355.080933,534.221985 355.479156,547.862366 356.438629,561.233948 C358.130676,584.814941 365.483582,607.193237 373.337097,629.325256 C377.003815,639.658325 381.512909,649.689758 385.401917,659.948303 C386.568451,663.025452 387.262756,666.374878 387.584961,669.657288 C388.084686,674.748962 384.880432,676.905884 380.411285,674.542358 C378.251343,673.400085 376.195312,671.788513 374.560638,669.968628 C360.665161,654.499207 346.153809,639.508545 333.228760,623.259338 C314.283722,599.442017 295.564880,575.337097 278.464294,550.188721 C259.097595,521.707825 243.782089,490.938232 236.760376,456.783600 C229.805786,422.955505 234.330795,390.643250 252.473038,361.086731 C260.966217,347.249969 270.924103,334.194489 281.254150,321.637177 C290.949463,309.851440 301.998169,299.177673 312.472534,288.034485 C334.109009,265.016541 356.426392,242.599243 374.762390,216.693787 C392.411499,191.758835 406.446655,165.157730 414.170410,135.346985 C415.729553,129.329361 419.626831,123.738441 423.206421,118.467079 C428.071259,111.302979 441.228149,111.158470 447.711761,116.578644 C452.807465,120.838554 457.838379,126.080994 460.697876,131.957550 C474.738770,160.813202 483.024597,191.435455 485.961182,223.394775 C487.116608,235.969574 487.913422,248.633255 487.850037,261.251312 C487.748688,281.438385 484.782837,301.331757 480.211060,321.027100 C475.195343,342.635162 465.426697,361.879120 452.541626,379.718384 C451.374054,381.334900 450.361908,383.063660 449.131653,385.068298"
            />
            <path
              fill={filledParts >= 3 ? "#1d4ed8" : "none"}
              d="M231.257904,729.737183 C206.863220,702.598267 182.536484,675.870605 164.445831,644.231995 C148.779800,616.833740 139.135849,587.547913 134.928757,556.256287 C130.717545,524.934082 137.311157,494.895691 145.101303,465.087311 C148.136307,453.474182 153.234589,442.242004 158.623413,431.450684 C163.198792,422.288361 171.328247,416.760773 182.193924,417.841064 C194.668045,419.081299 203.012924,426.356781 207.303284,437.830536 C209.916580,444.819214 211.440887,452.222961 213.333069,459.471954 C219.672760,483.759521 229.053986,506.906860 241.525055,528.580505 C250.445190,544.082886 260.444763,559.091675 271.238861,573.354858 C283.720001,589.847290 297.474518,605.388245 310.914490,621.138916 C321.364594,633.385681 332.798889,644.837158 342.693085,657.503479 C358.975677,678.348145 373.128174,700.558472 382.761475,725.466187 C392.624939,750.969055 396.760773,777.371826 397.029297,804.554138 C397.251434,827.036438 397.802948,849.517090 397.823395,871.998840 C397.829071,878.265015 397.073059,884.680786 395.584839,890.763245 C393.546692,899.093384 386.987854,901.587769 380.515747,895.962097 C374.341492,890.595215 368.632599,884.189331 364.357391,877.233276 C350.018677,853.903503 334.583069,831.421387 315.834747,811.426514 C301.500732,796.139587 286.884735,781.087891 271.827118,766.517517 C258.801056,753.912903 244.977081,742.132996 231.257904,729.737183"
            />
          </g>
        </svg>
      </div>

      <div className={`loading-text${showText ? '' : ' hidden-text'}`}>
        Carregando...
      </div>
    </div>
  );
};

export default LoadingScreen;